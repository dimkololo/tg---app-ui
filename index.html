<!DOCTYPE html>
<html lang="ru" data-app-lang>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Plam — WebApp</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- i18n (реализуешь в i18n.js; здесь только подключение) -->
  <script src="./i18n.js"></script>

  <link rel="stylesheet" href="./style.css?v=51" />
</head>
<body class>
  <main class="scene">
    <div class="stage" data-stage>
      
      <div class="decal decal--plane" aria-hidden="true"></div>
      
      <!-- Кликабельная зона «Действия» -->
      <button class="hotspot hotspot--actions" type="button" aria-label="Открыть меню действий"></button>

      <!-- Кликабельная зона по листочку на телевизоре в якоре -->
      <div class="anchor anchor--tv">
        <button class="hotspot hotspot--wintable" aria-label="Лидеры"></button>
      </div>

      <!-- Хот-споты -->
      <div class="anchor anchor--stump">
        <button
          class="hotspot hotspot--stump"
          type="button"
          data-open-modal="upload-popup"
          aria-label="Открыть попап загрузки"
        ></button>
        <!-- декоративные наклейки поверх фона -->
        <div class="decal decal--photohereru" aria-hidden="true"></div>
      </div>

      <!-- Плюс-облако отдельным слоем с индикатором баланса -->
      <button
        class="hotspot hotspot--plus"
        type="button"
        data-open-modal="buy-stars"
        aria-label="Открыть попап звёзд"
      >
        <span class="plus-ui" aria-hidden="true">
          <span id="plusValue" class="plus-value">0</span>
          <img class="plus-currency"
               src="./bgicons/earth-item.png"
               srcset="./bgicons/earth-item.png 1x, ./bgicons/earth-item@2x.png 2x"
               alt="">
        </span>
      </button>

      <button
        class="hotspot hotspot--faq"
        type="button"
        data-open-modal="faq"
        aria-label="Открыть FAQ"
      ></button>

      <button
        class="hotspot hotspot--gift"
        type="button"
        data-open-modal="prizes"
        aria-label="Открыть попап призов"
      ></button>

      <button
        class="hotspot hotspot--notebook"
        type="button"
        data-open-modal="profile"
        aria-label="Открыть профиль"
      ></button>
    </div>
  </main>

  <!-- Оверлей при горизонтальной ориентации -->
  <div id="orientationLock" class="orientation-lock" aria-hidden="true"></div>

  <!-- Универсальная модалка -->
  <div class="modal" data-modal-root hidden aria-hidden="true">
    <div class="modal__backdrop" data-dismiss></div>
    <div class="modal__dialog" role="dialog" aria-modal="true">
      <button class="modal__close" type="button" aria-label="Закрыть" data-dismiss>×</button>
      <div class="modal__content" data-modal-content></div>
    </div>
  </div>

  <!-- ВТОРОЙ СЛОЙ МОДАЛКИ (для таймера и пр.) -->
  <div class="modal modal--stack" data-modal-stack hidden aria-hidden="true">
    <div class="modal__backdrop" data-dismiss-stack></div>
    <div class="modal__dialog" role="dialog" aria-modal="true">
      <button class="modal__close" type="button" aria-label="Закрыть" data-dismiss-stack>×</button>
      <div class="modal__content" data-stack-content></div>
    </div>
  </div>

  <!-- Попап 1: загрузка фото -->
  <template id="tpl-upload-popup">
    <section class="popup upload-popup">
      <div class="u-center">
        <div class="pick-wrap">
          <button class="btn-pick" type="button" data-i18n="upload.pick">Выбрать фото</button>
          <!-- инпут без hidden/display:none -->
          <input id="file-input" class="file-input-overlay" type="file" accept="image/*"/>
          <!-- Кнопка «!» справа от «Выбрать фото» (правила) -->
          <button class="btn-info" type="button" aria-label="Правила" title="Правила" data-open-policy>!</button>
        </div>
      </div>

      <!-- ПРЕДПРОСМОТР -->
      <div class="picked-box" data-picked>
        <div class="picked-empty" data-i18n="upload.empty">Фото не выбрано</div>
        <figure class="picked-item" hidden>
          <img data-picked-img alt="">
          <button type="button" class="picked-remove" aria-label="Убрать фото" data-remove-photo>×</button>
        </figure>
      </div>

      <div class="card slider-card">
        <div class="slider-title" data-i18n="upload.boost_title">Увеличить эфирное время</div>
        <div class="slider-row">
          <span class="label" data-stars>0 PLAMc</span>
          <input class="range" type="range" min="0" max="20" step="1" value="0" />
          <span class="label" data-secs>0 сек</span>
        </div>
      </div>

      <form class="card form-card" data-upload-form novalidate>
        <!-- Ссылка -->
        <div class="field-wrap">
          <input
            class="field"
            type="url"
            name="social"
            placeholder="...ссылка на соц.сеть или сайт"
            maxlength="255"
            inputmode="url"
            enterkeyhint="next" 
            data-counter="link"
            data-i18n-placeholder="upload.link_ph"
          />
          <div class="field-counter" data-counter-for="link">0 / 255</div>
        </div>

        <!-- Описание -->
        <div class="field-wrap">
          <textarea
            class="field"
            name="desc"
            rows="3"
            placeholder="...описание"
            maxlength="220"
            enterkeyhint="done" 
            data-counter="desc"
            data-i18n-placeholder="upload.desc_ph"
          ></textarea>
          <div class="field-counter" data-counter-for="desc">0 / 220</div>
        </div>

        <div class="u-center" data-cd-row hidden>
          <div data-cd-text></div>
        </div>

        <div class="u-center">
          <button type="submit" data-submit class="btn btn-accent btn-submit" disabled>
            <span data-i18n="upload.submit_20s">В эфир на 20 секунд</span>
          </button>
        </div>
      </form>
    </section>
  </template>

  <!-- Сброс таймера -->
  <template id="tpl-reset-cooldown">
    <section class="popup reset-popup">
      <p class="reset-title" data-i18n="upload.reset_title">Сбросить <span data-mins>0</span> минут за <span data-coins>0</span> PLAMc</p>
      <div class="u-center">
        <button class="btn-pay btn-pay--green" type="button" data-reset-now data-i18n="common.confirm">Подтвердить</button>
      </div>
    </section>
  </template>

  <!-- Политика: одноразовое согласие -->
  <template id="tpl-policy-required">
    <section class="popup policy-popup">
      <h3 class="modal__title" data-i18n="policy.title">Правила отправки фото</h3>
      <div class="policy-body is-scrollable">
        <p data-i18n="policy.ban">Запрещено: обнажёнка/эротика; алкоголь/табак/наркотики; насилие и опасные действия; дискриминация/экстремизм; реклама, QR-коды, ссылки и контакты; личные/конфиденциальные данные; чужие фото без согласия; попытки обхода модерации.</p>
        <p data-i18n="policy.req">Требования: безопасный сюжет, без водяных знаков и крупных надписей, приличное качество.</p>
        <p data-i18n="policy.note">Отправляя фото, вы подтверждаете, что вам 13+ и у вас есть права на изображение. Мы можем удалять материалы и ограничивать доступ при нарушениях.</p>
      </div>
      <label class="policy-check">
        <input type="checkbox" id="policyAgree">
        <span data-i18n="policy.checkbox">Мне 13+ и я согласен с правилами</span>
      </label>
      <div class="modal__actions">
        <button class="btn" data-dismiss data-i18n="common.cancel">Отмена</button>
        <button class="btn btn-primary" id="policyAccept" disabled data-i18n="common.accept">Принять</button>
      </div>
    </section>
  </template>

  <!-- Политика: просто информация (без чекбокса) -->
  <template id="tpl-policy-info">
    <section class="popup policy-popup">
      <h3 class="modal__title" data-i18n="policy.title">Правила отправки фото</h3>
      <div class="policy-body is-scrollable">
        <p data-i18n="policy.ban">Запрещено: обнажёнка/эротика; алкоголь/табак/наркотики; насилие и опасные действия; дискриминация/экстремизм; реклама, QR-коды, ссылки и контакты; личные/конфиденциальные данные; чужие фото без согласия; попытки обхода модерации.</p>
        <p data-i18n="policy.req">Требования: безопасный сюжет, без водяных знаков и крупных надписей, приличное качество.</p>
        <p data-i18n="policy.note">Отправляя фото, вы подтверждаете, что вам 13+ и у вас есть права на изображение. Мы можем удалять материалы и ограничивать доступ при нарушениях.</p>
      </div>
      <div class="modal__actions">
        <button class="btn btn-primary" data-dismiss data-i18n="common.ok">Понятно</button>
      </div>
    </section>
  </template>

  <!-- Попап 2: покупка PLAMc -->
  <template id="tpl-buy-stars">
    <section class="popup shop-popup">
      <div class="chip shop-header">
        <img class="shop-header__icon" src="./bgicons/star-header.png" srcset="./bgicons/star-header.png 1x, ./bgicons/star-header@2x.png 2x" alt="">
        <h3 class="shop-title" data-i18n="shop.title">Обменять</h3>
        <p class="shop-subtitle" data-i18n="shop.sub">Выберите количество звезд</p>
      </div>

      <div class="shop-list">
        <button class="chip shop-item" type="button" data-amount="25">
          <span class="shop-item__left">
            <img src="./bgicons/star-item.png" srcset="./bgicons/star-item.png 1x, ./bgicons/star-item@2x.png 2x" alt="">
            <span data-i18n="shop.item_25">25 звезд</span>
          </span>
          <span class="shop-item__right">
            <span class="shop-num">25 PLAMc</span>
            <img src="./bgicons/earth-item.png" srcset="./bgicons/earth-item.png 1x, ./bgicons/earth-item@2x.png 2x" alt="">
          </span>
        </button>

        <button class="chip shop-item" type="button" data-amount="75">
          <span class="shop-item__left">
            <img src="./bgicons/star-item.png" srcset="./bgicons/star-item.png 1x, ./bgicons/star-item@2x.png 2x" alt="">
            <span data-i18n="shop.item_75">75 звезд</span>
          </span>
          <span class="shop-item__right">
            <span class="shop-num">75 PLAMc</span>
            <img src="./bgicons/earth-item.png" srcset="./bgicons/earth-item.png 1x, ./bgicons/earth-item@2x.png 2x" alt="">
          </span>
        </button>

        <button class="chip shop-item" type="button" data-amount="100">
          <span class="shop-item__left">
            <img src="./bgicons/star-item.png" srcset="./bgicons/star-item.png 1x, ./bgicons/star-item@2x.png 2x" alt="">
            <span data-i18n="shop.item_100">100 звезд</span>
          </span>
          <span class="shop-item__right">
            <span class="shop-num">100 PLAMc</span>
            <img src="./bgicons/earth-item.png" srcset="./bgicons/earth-item.png 1x, ./bgicons/earth-item@2x.png 2x" alt="">
          </span>
        </button>

        <button class="chip shop-item" type="button" data-amount="350">
          <span class="shop-item__left">
            <img src="./bgicons/star-item.png" srcset="./bgicons/star-item.png 1x, ./bgicons/star-item@2x.png 2x" alt="">
            <span data-i18n="shop.item_350">350 звезд</span>
          </span>
          <span class="shop-item__right">
            <span class="shop-num">350 PLAMc</span>
            <img src="./bgicons/earth-item.png" srcset="./bgicons/earth-item.png 1x, ./bgicons/earth-item@2x.png 2x" alt="">
          </span>
        </button>

        <button class="chip shop-item" type="button" data-amount="750">
          <span class="shop-item__left">
            <img src="./bgicons/star-item.png" srcset="./bgicons/star-item.png 1x, ./bgicons/star-item@2x.png 2x" alt="">
            <span data-i18n="shop.item_750">750 звезд</span>
          </span>
          <span class="shop-item__right">
            <span class="shop-num">750 PLAMc</span>
            <img src="./bgicons/earth-item.png" srcset="./bgicons/earth-item.png 1x, ./bgicons/earth-item@2x.png 2x" alt="">
          </span>
        </button>

        <button class="chip shop-item" type="button" data-amount="1500">
          <span class="shop-item__left">
            <img src="./bgicons/star-item.png" srcset="./bgicons/star-item.png 1x, ./bgicons/star-item@2x.png 2x" alt="">
            <span data-i18n="shop.item_1500">1500 звезд</span>
          </span>
          <span class="shop-item__right">
            <span class="shop-num">1500 PLAMc</span>
            <img src="./bgicons/earth-item.png" srcset="./bgicons/earth-item.png 1x, ./bgicons/earth-item@2x.png 2x" alt="">
          </span>
        </button>
      </div>
    </section>
  </template>

  <!-- FAQ -->
  <template id="tpl-faq">
    <section class="popup faq-popup">
      <div class="chip faq-card">
        <h3 class="faq-title" data-i18n="faq.title">FAQ</h3>
        <div class="faq-scroll">
          <p>Lorem ipsum dolor sit amet...</p>
          <!-- ... контент без изменений ... -->
        </div>
        <div class="u-center">
          <button class="btn-close-timer" type="button" data-dismiss data-i18n="common.close">Закрыть</button>
        </div>
      </div>
    </section>
  </template>

  <!-- Попап 3: призы -->
  <template id="tpl-prizes">
    <section class="popup prizes-popup">
      <div class="prize-grid" data-prize-grid></div>
      <div class="u-center"><button class="btn-pay" type="button" disabled data-i18n="prizes.pay">Выплатить</button></div>
      <p class="pay-note" data-i18n="prizes.note">Нажимая кнопку «Выплатить» вы подтверждаете, что ознакомлены с правилами и публичной офертой.</p>
    </section>
  </template>

  <!-- Попап 4: профиль -->
  <template id="tpl-profile">
    <section class="popup profile-popup">
      <div class="chip profile-header">
        <div class="avatar" data-avatar></div>
        <div class="profile-id" data-username>@tg profile</div>
        <button class="btn-premium" type="button" data-btn-premium data-i18n="profile.get_premium">Получить премиум</button>
      </div>

      <!-- Переключатель языка -->
      <div class="chip" style="width:100%; max-width:420px; display:flex; gap:8px; justify-content:center;">
        <button class="lang-btn" type="button" data-set-lang="ru">RU</button>
        <button class="lang-btn" type="button" data-set-lang="en">EN</button>
      </div>

      <div class="chip profile-card">
        <div class="row">
          <div class="label-left" data-i18n="profile.photos_count">Количество фото:</div>
          <div class="pill pill-orange" data-photo-count>0</div>
        </div>
        <div class="hint" data-i18n="profile.photos_hint">Количество фото влияет на время их отображения. 100 фото = +1 секунда</div>
      </div>

      <div class="chip profile-card">
        <div class="row">
          <div class="label-left" data-i18n="profile.show_time">Время показа фото:</div>
          <div class="val-right" data-show-seconds>20 сек</div>
        </div>
      </div>
    </section>
  </template>

  <!-- Попап: таймер премиума -->
  <template id="tpl-premium-timer">
    <section class="popup timer-popup">
      <div class="chip timer-card">
        <h3 class="timer-title" data-i18n="premium.active">Премиум активен</h3>
        <div class="timer-remaining" data-remaining>30д. 0ч. 0мин.</div>
        <p class="timer-note" data-i18n="premium.countdown">Обратный отсчёт до окончания подписки</p>
        <div class="u-center"><button class="btn-close-timer" type="button" data-dismiss-stack data-i18n="common.ok">Ок</button></div>
      </div>
    </section>
  </template>

  <!-- Попап: помощь по премиуму -->
  <template id="tpl-premium-help">
    <section class="popup help-popup">
      <div class="chip" style="width:100%; max-width:420px;">
        <h3 class="subs-title" style="margin-top:0;" data-i18n="premium.about_title">Что такое премиум?</h3>
        <div class="help-body" style="color:#000; opacity:.9; font-size:14px; line-height:1.45;">
          <p>...</p>
        </div>
        <div class="u-center" style="margin-top:12px;">
          <button class="btn-close-timer" type="button" data-dismiss-stack data-i18n="common.ok">Ок</button>
        </div>
      </div>
    </section>
  </template>

  <!-- Попап: обязательная подписка -->
  <template id="tpl-subs-required">
    <section class="popup subs-popup">
      <div class="chip subs-card">
        <h3 class="subs-title" data-i18n="subs.title">Подписка обязательна</h3>
        <p class="subs-sub" data-i18n="subs.sub">Подпишитесь на наши каналы, чтобы отправлять фото.</p>

        <div class="subs-links">
          <a class="btn-link" href="https://youtube.com/@p.l.a.m?si=eYNmdfzUSjF8qwPk" target="_blank" rel="noopener" data-sub-yt data-i18n="subs.yt">Youtube канал</a>
          <a class="btn-link" href="https://t.me/ninaiart" target="_blank" rel="noopener" data-sub-tg data-i18n="subs.tg">Telegram канал</a>
        </div>

        <div class="u-center">
          <button class="btn-check" type="button" data-check-subs data-i18n="subs.check">Проверить подписки</button>
        </div>

        <p class="subs-note" data-i18n="subs.note">После успешной проверки можно закрыть окно и отправить фото.</p>
      </div>
    </section>
  </template>

  <!-- Подтверждение премиума -->
  <template id="tpl-confirm-premium">
    <section class="popup confirm-popup">
      <div class="chip confirm-card">
        <p class="confirm-text" data-i18n="premium.confirm_text">Вы хотите получить премиум на 7 дней за 350 PLAMc?</p>
        <div class="confirm-actions">
          <button class="btn-confirm yes" type="button" data-confirm-yes data-i18n="common.yes">Да</button>
          <button class="btn-confirm no" type="button" data-dismiss-stack data-i18n="common.no">Нет</button>
        </div>
      </div>
    </section>
  </template>

  <!-- Попап таблицы лидеров (без изменений по i18n, при желании пометишь сам) -->
  <div class="modal" id="leadersModal" hidden>
    <div class="modal__backdrop" data-close="leadersModal"></div>
    <div class="modal__dialog">
      <button class="modal__close" data-close="leadersModal" aria-label="Закрыть">×</button>
      <div class="modal__content is-scrollable">
        <div class="leaderboard-popup">
          <!-- ... существующая разметка ... -->
          <div class="lb-footer">
            <button class="btn-close-timer" data-close="leadersModal" data-i18n="common.close">Закрыть</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Скрипты -->
  <script src="./app.js?v=52"></script>
</body>
</html>
